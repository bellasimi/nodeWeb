<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>회원 목록</title>
</head>

<body>
<nav class="nav nav-pills nav-fill">
    <a class="nav-link active"  href="/addGoodsForm">addGoods</a>
    <a class="nav-link" href="/list">List</a>
    <a class="nav-link" href="/write">write</a>
    <a class="nav-link" href="/goodsList">Goods</a>
</nav>
<h2 class="ml-4 my-10"> 회원 목록 </h2>
<table class="table">
  <thead class="table-dark">
    <tr>
      <th scope="col">Name</th>
      <th scope="col">PW</th>
      <th scope="col">Email</th>
      <th scope="col">Delete</th>
    </tr>
  </thead>
  <tbody>

    <% for(var i= 0; i< data.length; i++){ %>
    <tr>
      <th scope="row"><%= data[i].name %></th>
      <td><%= data[i].pw %></td>
      <td><%= data[i].email %></td>
      <td>
        <button type="button" class="delBtn" data-id="<%= data[i]._id %>">삭제</button>
      </td>
    </tr>
    <% }%>
  </tbody>
</table>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script>

/*     let delBtn = document.querySelector('.delBtn');

    delBtn.addEventListener("click",function(e){
    console.log("삭제!")
        $.ajax({
            method : 'DELETE',
            url : '/delete',
            data : { _id: e.target.dataset.id }
        }).done(function(result){
            console.log(result.msg)
            console.log($(this).parent('tr').fadeOut())
            $(this).parent('tr').fadeOut();
        }).fail(function(xhr, textStatus, errorThrown ){
            console.log(xhr, textStatus, errorThrown);
        })
    }); */


/*   jquery 방식 */


$('.delBtn').click(function(e){
     $.ajax({
         method : 'DELETE',
         url : '/delete',
         data : { _id: e.target.dataset.id }
     }).done(function(result){
         console.log(result.msg)
         $(this).parent('tr').fadeOut();

     }).fail(function(xhr, textStatus, errorThrown ){
        console.log(xhr, textStatus, errorThrown);
     })

 })


</script>

</body>
</html>